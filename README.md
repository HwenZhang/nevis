# NEVIS: A model for subglacial hydrology with blisters

The repository contains the MATLAB/Python code for simulating the subglacial hydrological system that incorporates the effects of supraglacial lake drainage and suglacial blisters. The model is described in [Zhang et al. (2025)](). The model builds upon the subglacial hydrology model of [Hewitt (2013)](https://doi.org/10.1016/j.epsl.2013.04.022), extending it to include the formation and evolution of subglacial blisters caused by supraglacial lake drainage events.

The schematic of the model setup is shown below
<p align="center">
  <img src="./figures/Fig1_schematic.png" alt="Model Schematic" width="500">
</p>

# Contents
The repository contains the essential files for running the model and visualising the results. The directory structure is as follows:
```
.
├── README.md
├── figures/                   # Figures in the manuscript
├── results/
│   └── {casename}/            # Simulation results for each case
├── src/                       # Essential source files
├── srcgen/                    # Python scripts to generate MATLAB scripts for parameter sweep
├── srcplot/                   # Python/MATLAB scripts for visualisation
└── generated_scripts/         # MATLAB scripts that can be run directly
```

# How to run
1. Clone the repository to your local machine.
2. Generate the matlab scripts for a given parameter combination using the Python scripts in the `./srcgen` folder. Note that you need to move the `*.ipynb` scripts from `./srcgen` to `./` before running them. You can modify the parameters in the scripts as needed. The generated scripts will be saved in the `./generated_scripts` folder. In general, they can be categorised into three types:
    - Reference scripts (generated by `reference_scripts.ipynb`): Scripts that run the idealised cases in a rectangular domain without basal heterogeneity.
    - Regional scripts (generated by `regional_study_scripts.ipynb`): Scripts that run the cases in a regional domain with bed topography.
    - Convergence test scripts (generated by `convergence_test_scripts.ipynb`): Scripts that run the convergence tests for spatial resolution.
Note that all cases consist of two stages: spinup and drainage. The spinup stage brings the system to a quasi-steady state, which is then used as the initial condition for the drainage stage.

3. The bash script `nevis_run.sh` can be modified to run the generated matlab scripts. It moves the generated scripts to the main folder `./` and runs them one by one, saving the results in the `./results/{casename}` folder. The script automatically handles the spinup and drainage stages by prioritising the spinup scripts. Otherwise, you can run the matlab scripts directly in MATLAB after moving them to `./`.

4. Use the scripts in the `./srcplot` folder to visualise the results. You can modify the scripts as needed. Note that you need to move the scripts to `./` before running them. The visualisation scripts can generate plots and animations similar to those in the manuscript:
    - `schematic.ipynb`: Generate the schematic figure (Figure 1).
    - `make_plot.ipynb`: Generate static plots like Figures 2-7.
    - `convergence_test.ipynb`: Generate convergence test plots (Figure B1, B2).
    - `animation.ipynb`: Generate animations in the supplementary material.

5. Detailed implementation of the model is in `./src` folder. Users can refer to the attached documentation `./docs/nevis.pdf` for more information about the model.

# References
Please cite the following paper when using this code.

Zhang, H., Stevens, L. A., Hewitt, I. J., & Stuart, H. (in prep). A unified blister and subglacial hydrology
framework for supraglacial lake drainage events. Journal of Geophysical Research: Earth Surface.

Hewitt, I. J. (2013, June). Seasonal changes in ice sheet motion due to melt water lubrication. Earth and Planetary Science Letters, 371–372 , 16–25. [doi: 10.1016/j.epsl.2013.04.022](https://doi.org/10.1016/j.epsl.2013.04.022)

Stevens, L. A., Hewitt, I. J., Das, S. B., & Behn, M. D. (2018, September). Relationship Between Greenland Ice Sheet Surface Speed and Modeled Effective Pressure. Journal of Geophysical Research: Earth Surface, 123 (9), 2258–2278. [doi: 10.1029/2017JF004581](https://doi.org/10.1029/2017JF004581)
